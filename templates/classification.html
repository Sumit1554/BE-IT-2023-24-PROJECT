<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="{{ url_for('static', filename='index.css') }}">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
  <title>Forest Analysis</title>

  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f4f4f4;
    }

    h2,
    h3 {
      color: #333;
      padding: 20px;
    }

    h3 {
      display: flex;
      align-items: center;
    }

    input[type="file"] {
      display: block;
      margin: 20px;
    }

    button {
      background-color: #4CAF50;
      /* Green */
      border: none;
      color: white;
      padding: 15px 32px;
      text-align: center;
      text-decoration: none;
      display: inline-block;
      font-size: 16px;
    }

    .image-container {
      display: flex;
      justify-content: space-around;
    }

    .image-container img {
      max-width: calc(50% - 40px);
    }

    #green-cover-percentage {
      font-size: 24px;
    }

    #idle-land-percentage {
      font-size: 24px;
    }
  </style>

</head>

<body style="background-color:wheat;">
  <header style="height: 60px;">
    <h1>Classification</h1>

  </header>




  <!-- navbar -->
  <div style="padding: 5px;">
    <nav class="navbar navbar-expand-lg fixed-top navbar-dark bg-dark" style="border-radius: 5px;">
      <div class="container-fluid">
        <!-- <a class="navbar-brand" href="#">Forest Analysis</a> -->
        <a class="navbar-brand" href="#">
          <img src="{{ url_for('static', filename='img/logo_final.png') }}" alt="Logo" width="30" height="24"
            class="d-inline-block align-text-top" />
          <i>Forest Analysis</i>
        </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"
          aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav me-auto mb-2 mb-lg-0">
            <li class="nav-item">
              <a class="nav-link" aria-current="page" href="{{url_for('index')}}">Home</a>
            </li>
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle active " href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown"
                aria-expanded="false">
                Modules
              </a>
              <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                <li><a class="dropdown-item" href="{{url_for('enumeration')}}">Tree Enumeration</a></li>
                <li><a class="dropdown-item" href="#">Classification</a></li>
                <li><a class="dropdown-item" href="{{url_for('weather')}}">Environment Data</a></li>
              </ul>
            <li class="nav-item">
              <a class="nav-link" aria-current="page" href="{{ url_for('about') }}">About Us</a>
            </li>
            </li>
          </ul>
          <form class="d-flex">
            <!-- <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search">
                <button class="btn btn-outline-success" type="submit">Search</button> -->
          </form>
        </div>
      </div>
    </nav>
  </div>


  <div>
    <center>
      <h2>Green Cover Estimator</h2>

      <input type="file" id="image-file" accept="image/*">
      <button class="btn btn-outline-success" onclick="processImage()">Process Image</button>
    </center>
    <h3>Processed Image:</h3>
    <div class="image-container">
      <img id="uploaded-image" src="" alt="Uploaded Image">
      <img id="processed-image" src="" alt="Processed Image">
    </div>

    <div style="text-align: center;">
      <h4>Green Cover Percentage: <span id="green-cover-percentage"></span></h4>
      <p id="green-cover-percentage"></p>
      <h4>Idle Land Percentage: <span id="idle-land-percentage"></span></h4>
      <p id="idle-land-percentage"></p>
    </div>
    <script>
      function processImage() {
        const fileInput = document.getElementById('image-file');
        const file = fileInput.files[0];
        const reader = new FileReader();

        reader.onloadend = () => {
          const uploadedImage = document.getElementById('uploaded-image');
          const processedImage = document.getElementById('processed-image');
          const greenCoverPercentage = document.getElementById('green-cover-percentage');
          const idleLandPercentage = document.getElementById('idle-land-percentage');

          const img = new Image();
          img.onload = () => {
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');

            canvas.width = img.width;
            canvas.height = img.height;
            ctx.drawImage(img, 0, 0);

            let imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
            let blackPixelCount = 0;

            // Calculate the mean green value
            let totalGreen = 0;
            for (let i = 1; i < imageData.data.length; i += 4) {
              totalGreen += imageData.data[i];
            }
            const meanGreen = totalGreen / (imageData.data.length / 4);

            for (let i = 0; i < imageData.data.length; i += 4) {
              let gray = (imageData.data[i + 1]) * 0.587; // Keep only green channel

              if (gray < meanGreen / 1.5) {
                gray = 0;
                blackPixelCount++;
              } else {
                gray = 255;
              }

              imageData.data[i] = gray;   // Red channel
              imageData.data[i + 1] = gray; // Green channel
              imageData.data[i + 2] = gray; // Blue channel
              imageData.data[i + 3] = 255;  // Alpha channel
            }

            ctx.putImageData(imageData, 0, 0);

            // Display the processed image and green cover percentage
            processedImage.src = canvas.toDataURL();
            greenCoverPercentage.textContent = ((blackPixelCount / (canvas.width * canvas.height)) * 100).toFixed(2) + '%';
            idleLandPercentage.textContent = (100 - ((blackPixelCount / (canvas.width * canvas.height)) * 100)).toFixed(2) + '%';
          };
          img.src = reader.result;

          // Display the uploaded image
          uploadedImage.src = reader.result;
        };

        reader.readAsDataURL(file);
      }
    </script>
  </div>


  <footer>
    <!-- <p>&copy; 2023 Your Website Name. All rights reserved.</p> -->
    <p id="fp"> <b>Contact Us</b></p>

    <div class="centrediv">
      <a class="a1" href="#" target="_blank">
        <i class="fa fa-2x fa-facebook"> </i>
      </a>

      <a class="a1" href="#" target="_blank">
        <i class="fa fa-2x fa-instagram"> </i>
      </a>

      <a class="a1" href="#" target="_blank">
        <i class="fa fa-2x fa-linkedin"> </i>
      </a>

      <a class="a1" href="#" target="_blank">
        <i class="fa fa-2x fa-twitter"> </i>

      </a>
      <br />
    </div>
    <br>
    <center>
      <div><i class="fa fa-1x fa-phone"> 9322952900 </i></div>
    </center>
    <center>
      <div><i class="fa fa-1x fa-envelope"> sdfoundation001@gmail.com </i></div>
    </center>

    <center>
      <div> Â© 2023 SD_Foundation. All rights reserved. </div>
    </center>
  </footer>
  <!-- Optional JavaScript; choose one of the two! -->

  <!-- Option 1: Bootstrap Bundle with Popper -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
    crossorigin="anonymous"></script>

  <!-- Option 2: Separate Popper and Bootstrap JS -->
  <!--
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>
    -->
</body>

</html>